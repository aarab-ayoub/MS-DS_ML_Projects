<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>PetVision AI - Dataset & Training</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    .drop-zone {
      border: 2px dashed #6b7280;
      border-radius: 12px;
      padding: 20px;
      text-align: center;
      cursor: pointer;
      transition: background-color 0.3s ease;
    }
    .drop-zone.dragover {
      background-color: rgba(255, 255, 255, 0.1);
    }
    .image-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 16px;
    }
    .loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      display: flex;
      justify-content: center;
      align-items: center;
      color: white;
      font-size: 1.5rem;
      z-index: 1000;
      display: none; /* Hidden by default */
    }
  </style>
</head>
<body class="bg-gradient-to-br from-indigo-900 via-purple-800 to-pink-700 min-h-screen text-white">
  <div class="container mx-auto px-4 py-8">
    <!-- Header -->
    <header class="flex flex-col md:flex-row items-center justify-between mb-12">
      <div class="flex items-center">
        <div class="bg-white rounded-full p-2 mr-3 shadow-lg">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 text-purple-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z" />
          </svg>
        </div>
        <h1 class="text-3xl md:text-4xl font-bold text-white">PetVision AI</h1>
      </div>
      <nav class="mt-4 md:mt-0">
        <ul class="flex space-x-6">
          <li>
            <a href="{% url 'landing_page' %}" class="text-white hover:text-pink-200 font-medium">Home</a>
          </li>
          <li>
            <a href="{% url 'training_page' %}" class="text-white hover:text-pink-200 font-medium">Try It</a>
          </li>
          <li>
            <a href="{% url 'prediction_page' %}" class="text-white hover:text-pink-200 font-medium">Prediction</a>
          </li>
        </ul>
      </nav>
    </header>

    <!-- Dataset Section -->
    <section class="mb-12 px-6">
      <h2 class="text-4xl font-extrabold text-center text-white mb-12">Dataset Gallery</h2>
      
      <div class="max-w-6xl mx-auto">
        <!-- Cats & Dogs Container -->
        <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-5 gap-6">
          
          <!-- Cat Images -->
          {% for image in cat_images %}
          <div class="relative overflow-hidden rounded-xl shadow-lg group">
            <img src="{{ MEDIA_URL }}cats/{{ image }}" alt="Cat"
              class="w-full h-48 object-cover rounded-xl transition-all duration-300 group-hover:scale-105">
            <div class="absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 flex items-center justify-center text-white text-lg font-semibold transition-opacity">
              Cat üê±
            </div>
          </div>
          {% endfor %}
          
          <!-- Dog Images -->
          {% for image in dog_images %}
          <div class="relative overflow-hidden rounded-xl shadow-lg group">
            <img src="{{ MEDIA_URL }}dogs/{{ image }}" alt="Dog"
              class="w-full h-48 object-cover rounded-xl transition-all duration-300 group-hover:scale-105">
            <div class="absolute inset-0 bg-black bg-opacity-50 opacity-0 group-hover:opacity-100 flex items-center justify-center text-white text-lg font-semibold transition-opacity">
              Dog üê∂
            </div>
          </div>
          {% endfor %}
          
        </div>
      </div>
    </section>
    

    <!-- Drag-and-Drop Form -->
    <section class="mb-12">
      <h2 class="text-3xl font-bold text-center text-white mb-8">Upload Dataset</h2>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
        <!-- Cats Drop Zone -->
        <div class="drop-zone" id="cat-drop-zone">
          <p class="text-indigo-200">Drag and drop 10 cat images here</p>
          <input type="file" id="cat-input" accept="image/*" multiple class="hidden">
        </div>
        <!-- Dogs Drop Zone -->
        <div class="drop-zone" id="dog-drop-zone">
          <p class="text-indigo-200">Drag and drop 10 dog images here</p>
          <input type="file" id="dog-input" accept="image/*" multiple class="hidden">
        </div>
      </div>
    </section>

    <!-- Training Button -->
    <div class="text-center">
      <button id="train-button" class="bg-gradient-to-r from-pink-500 to-purple-600 text-white px-8 py-3 rounded-lg font-semibold shadow-lg hover:from-pink-600 hover:to-purple-700 transition duration-300">
        Train Model
      </button>
    </div>
  </div>

  <!-- Loading Overlay -->
  <div class="loading-overlay" id="loading-overlay">
    Training in progress... Please wait.
  </div>

  <script>
    const catDropZone = document.getElementById('cat-drop-zone');
    const dogDropZone = document.getElementById('dog-drop-zone');
    const catInput = document.getElementById('cat-input');
    const dogInput = document.getElementById('dog-input');
    const loadingOverlay = document.getElementById('loading-overlay');

    // Function to display uploaded images
    function displayUploadedImages(files, dropZone) {
      let previewContainer = dropZone.querySelector('.preview-container');

      // If no preview container exists, create one
      if (!previewContainer) {
        previewContainer = document.createElement('div');
        previewContainer.classList.add('flex', 'flex-wrap', 'gap-4', 'mt-4', 'preview-container');
        dropZone.appendChild(previewContainer);
      }

      Array.from(files).forEach((file) => {
        const reader = new FileReader();
        reader.onload = (e) => {
          const img = document.createElement('img');
          img.src = e.target.result;
          img.alt = file.name;
          img.classList.add('h-24', 'w-24', 'object-cover', 'rounded-lg', 'shadow-lg');
          previewContainer.appendChild(img);
        };
        reader.readAsDataURL(file);
      });
    }

    // Handle Drag-and-Drop for Cats
    catDropZone.addEventListener('dragover', (e) => {
      e.preventDefault();
      catDropZone.classList.add('dragover');
    });
    catDropZone.addEventListener('dragleave', () => {
      catDropZone.classList.remove('dragover');
    });
    catDropZone.addEventListener('drop', (e) => {
      e.preventDefault();
      catDropZone.classList.remove('dragover');
      const files = e.dataTransfer.files;
      if (files.length > 10) {
        alert('You can only upload up to 10 cat images at a time.');
        return;
      }
      displayUploadedImages(files, catDropZone);
      alert(`${files.length} cat images uploaded!`);
    });

    // Handle Drag-and-Drop for Dogs
    dogDropZone.addEventListener('dragover', (e) => {
      e.preventDefault();
      dogDropZone.classList.add('dragover');
    });
    dogDropZone.addEventListener('dragleave', () => {
      dogDropZone.classList.remove('dragover');
    });
    dogDropZone.addEventListener('drop', (e) => {
      e.preventDefault();
      dogDropZone.classList.remove('dragover');
      const files = e.dataTransfer.files;
      if (files.length > 10) {
        alert('You can only upload up to 10 dog images at a time.');
        return;
      }
      displayUploadedImages(files, dogDropZone);
      alert(`${files.length} dog images uploaded!`);
    });

    // Handle Training Button Click
    document.getElementById('train-button').addEventListener('click', () => {
      loadingOverlay.style.display = 'flex'; // Show loading overlay
      setTimeout(() => {
        window.location.href = '{% url "prediction_page" %}'; // Redirect after 3 seconds
      }, 3000);
    });
  </script>
</body>
</html>